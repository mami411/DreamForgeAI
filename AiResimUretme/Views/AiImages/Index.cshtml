@model IEnumerable<AiResimUretme.Models.AiImage>

@{
    ViewData["Title"] = "AI Galeri";
}

<div class="text-center mb-5">
    <h1 class="display-4">AI Resim Galerisi</h1>
    <p class="lead">Yapay zeka ile hayallerini görsele dönüştür.</p>

    <div class="d-flex justify-content-center gap-2">
        <a asp-action="Create" class="btn btn-lg btn-primary shadow">
            ✨ Yeni Resim Oluştur
        </a>

    </div>
</div>

<div class="row">
    @foreach (var item in Model)
    {
        <div class="col-md-4 mb-4">
            <div class="card h-100 shadow-sm">
                <img src="@item.ImageUrl"
                     class="card-img-top galeri-resim"
                     alt="@item.Prompt"
                     onclick="resmiAc(this)"
                     style="height: 250px; object-fit: cover;">

                <div class="card-body">
                    <h5 class="card-title text-truncate">@item.Prompt</h5>
                    <p class="card-text text-muted small">
                        <i class="bi bi-calendar"></i> @item.CreatedDate.AddHours(3).ToString("dd MMM yyyy HH:mm")
                    </p>
                </div>

                <div class="card-footer bg-white border-top-0 d-flex justify-content-between align-items-center">

                    <button class="btn btn-outline-secondary btn-sm"
                            onclick="promptKopyala(this)"
                            data-prompt="@item.Prompt">
                        <i class="bi bi-clipboard"></i> Kopyala
                    </button>

                    <a asp-action="Delete" asp-route-id="@item.Id" class="btn btn-outline-danger btn-sm">
                        <i class="bi bi-trash"></i> Sil
                    </a>
                </div>
            </div>
        </div>
    }
</div>

<div id="resimModal" class="ozel-modal" onclick="modalKapat()">
    <span class="kapat-tusu">&times;</span>
    <img class="modal-icerik" id="buyukResim">
</div>

<style>
    .galeri-resim {
        cursor: pointer;
        transition: 0.3s;
    }

        .galeri-resim:hover {
            opacity: 0.9;
            transform: scale(1.02);
        }

    .ozel-modal {
        display: none;
        position: fixed;
        z-index: 9999;
        padding-top: 50px;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0,0,0,0.9);
    }

    .modal-icerik {
        margin: auto;
        display: block;
        width: 80%;
        max-width: 1000px;
        max-height: 90vh;
        object-fit: contain;
        border-radius: 5px;
        animation-name: zoom;
        animation-duration: 0.6s;
    }

    @@keyframes zoom {
        from {
            transform: scale(0)
        }

        to {
            transform: scale(1)
        }
    }

    .kapat-tusu {
        position: absolute;
        top: 15px;
        right: 35px;
        color: #f1f1f1;
        font-size: 40px;
        font-weight: bold;
        transition: 0.3s;
        cursor: pointer;
        z-index: 10000;
    }

        .kapat-tusu:hover {
            color: #bbb;
            text-decoration: none;
        }
</style>

<script>
    function resmiAc(element) {
        var modal = document.getElementById("resimModal");
        var modalImg = document.getElementById("buyukResim");
        modal.style.display = "block";
        modalImg.src = element.src;
    }
    function modalKapat() {
        document.getElementById("resimModal").style.display = "none";
    }
    function promptKopyala(btn) {
        var promptMetni = btn.getAttribute("data-prompt");
        navigator.clipboard.writeText(promptMetni).then(function() {
            var eskiIcerik = btn.innerHTML;
            btn.classList.remove("btn-outline-secondary");
            btn.classList.add("btn-success");
            btn.innerHTML = "<i class='bi bi-check-lg'></i> Kopyalandı!";
            setTimeout(function() {
                btn.classList.remove("btn-success");
                btn.classList.add("btn-outline-secondary");
                btn.innerHTML = eskiIcerik;
            }, 2000);
        });
    }
</script>